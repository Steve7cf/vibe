/* ══════════════════════════════════════════════════════════════════
   VIBE — Production CSS  |  Syne · DM Sans  |  Dark & Alive
   ══════════════════════════════════════════════════════════════════ */

/* ─── Variables ─────────────────────────────────────────────────── */
:root {
  --titlebar-h:    50px;
  --player-h:      90px;
  --sidebar-w:     236px;
  --side-w:        260px;

  /* Density-controlled variables (overridden by JS) */
  --track-item-h:  58px;
  --nav-btn-py:    10px;
  --card-gap:      14px;
  --section-mb:    36px;
  --view-px:       32px;

  --bg:            #0d0d0d;
  --bg-1:          #141414;
  --bg-2:          #1c1c1c;
  --bg-3:          #252525;
  --bg-4:          #2e2e2e;
  --border:        rgba(255,255,255,0.08);
  --border-2:      rgba(255,255,255,0.14);

  --text-1:        #f2f2f2;
  --text-2:        #b0b0b0;
  --text-3:        #666;

  --accent:        #1db954;
  --accent-dim:    #158a3e;
  --accent-rgb:    29,185,84;

  --font-d:        'Syne', sans-serif;
  --font-b:        'DM Sans', sans-serif;
  --font-size-base: 14px;

  --ease:          cubic-bezier(.22,1,.36,1);
  --t:             160ms var(--ease);

  --r1: 7px;  --r2: 11px;  --r3: 16px;  --r4: 24px;
}

/* ─── Reset ─────────────────────────────────────────────────────── */
*,*::before,*::after { box-sizing:border-box; margin:0; padding:0; }
html,body { height:100%; overflow:hidden; background:var(--bg); color:var(--text-1); }
body { font-family:var(--font-b); font-size:var(--font-size-base); line-height:1.6;
       -webkit-font-smoothing:antialiased; }
button { font-family:var(--font-b); cursor:pointer; border:none; background:none; color:inherit; }
input,select { font-family:var(--font-b); color:inherit; }
img { display:block; max-width:100%; }
svg { stroke:currentColor; fill:none; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; }
.hidden { display:none !important; }

/* ─── Scrollbar ─────────────────────────────────────────────────── */
::-webkit-scrollbar { width:4px; height:4px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:rgba(255,255,255,0.1); border-radius:2px; }
::-webkit-scrollbar-thumb:hover { background:rgba(255,255,255,0.2); }

/* ─── App shell ─────────────────────────────────────────────────── */
#app { display:flex; flex-direction:column; height:100vh; overflow:hidden; }

/* ─── Titlebar ──────────────────────────────────────────────────── */
#titlebar {
  height:var(--titlebar-h); display:flex; align-items:center;
  gap:10px; padding:0 14px;
  background:rgba(8,8,8,0.95); backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
  -webkit-app-region:drag; flex-shrink:0; z-index:100;
}
.titlebar-left { display:flex; align-items:center; gap:8px; -webkit-app-region:no-drag; }
.app-name { font-family:var(--font-d); font-weight:800; font-size:15px; letter-spacing:-.3px; }
.titlebar-center { flex:1; display:flex; justify-content:center; }
.titlebar-right { display:flex; align-items:center; gap:7px; -webkit-app-region:no-drag; }

.win-btn {
  width:26px; height:26px; border-radius:50%; font-size:12px;
  display:flex; align-items:center; justify-content:center;
  background:rgba(255,255,255,0.06); color:var(--text-3);
  transition:var(--t); -webkit-app-region:no-drag;
}
.win-btn:hover { background:rgba(255,255,255,0.14); color:var(--text-1); }
.win-btn.close:hover { background:#e5534b; color:#fff; }

/* Search */
.search-wrap { position:relative; display:flex; align-items:center;
  width:clamp(180px,28vw,360px); -webkit-app-region:no-drag; }
.search-icon { position:absolute; left:11px; width:14px; height:14px;
  stroke:var(--text-3); pointer-events:none; }
#search-input {
  width:100%; background:rgba(255,255,255,0.055); border:1px solid var(--border);
  border-radius:18px; padding:7px 32px 7px 34px;
  font-size:13.5px; color:var(--text-1); outline:none; transition:var(--t);
}
#search-input:focus { border-color:var(--border-2); background:rgba(255,255,255,0.09); }
#search-input::placeholder { color:var(--text-3); }
.search-clear { position:absolute; right:10px; font-size:11px; color:var(--text-3);
  opacity:0; pointer-events:none; transition:var(--t); }
.search-clear.visible { opacity:1; pointer-events:auto; }

/* Top buttons */
.topbar-btn {
  display:flex; align-items:center; gap:6px; padding:6px 12px;
  border-radius:var(--r2); font-size:12.5px; font-weight:500; color:var(--text-2);
  background:rgba(255,255,255,0.05); border:1px solid var(--border);
  transition:var(--t); white-space:nowrap; -webkit-app-region:no-drag;
}
.topbar-btn svg { width:13px; height:13px; flex-shrink:0; }
.topbar-btn:hover { background:rgba(255,255,255,0.1); color:var(--text-1); border-color:var(--border-2); }

/* ─── Layout ─────────────────────────────────────────────────────── */
#layout { display:flex; flex:1; min-height:0; overflow:hidden; }

/* ─── Sidebar ────────────────────────────────────────────────────── */
#sidebar {
  width:var(--sidebar-w); flex-shrink:0;
  display:flex; flex-direction:column;
  background:rgba(8,8,8,0.7); border-right:1px solid var(--border);
  overflow-y:auto; overflow-x:hidden; user-select:none;
}
.sidebar-nav { padding:14px 10px 0; display:flex; flex-direction:column; gap:2px; }
.nav-btn {
  display:flex; align-items:center; gap:13px; padding:var(--nav-btn-py) 14px;
  border-radius:var(--r2); font-size:14px; font-weight:500; color:var(--text-3);
  transition:var(--t); text-align:left; width:100%;
}
.nav-btn svg { width:17px; height:17px; flex-shrink:0; }
.nav-btn:hover  { background:var(--bg-3); color:var(--text-2); }
.nav-btn.active { background:var(--bg-3); color:var(--text-1); }
.nav-btn.active svg { stroke:var(--accent); }

.sidebar-playlists { padding:20px 10px 14px; flex:1; }
.sidebar-section-title { font-size:10px; font-weight:700; letter-spacing:1.8px;
  color:var(--text-3); padding:0 6px; margin-bottom:8px; }
.sidebar-pl-item {
  padding:8px 12px; border-radius:var(--r2); font-size:13px; color:var(--text-3);
  cursor:pointer; transition:var(--t); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.sidebar-pl-item:hover  { background:var(--bg-3); color:var(--text-2); }
.sidebar-pl-item.active { color:var(--text-1); }
.create-pl-btn {
  width:100%; margin-top:8px; padding:8px 12px; border-radius:var(--r2);
  font-size:13px; color:var(--text-3); text-align:left;
  border:1px dashed var(--border); transition:var(--t);
}
.create-pl-btn:hover { border-color:var(--accent); color:var(--accent); }

/* ─── Content ────────────────────────────────────────────────────── */
#content { flex:1; min-width:0; overflow-y:auto; overflow-x:hidden; position:relative; }
.view { display:none; padding:30px var(--view-px) 48px; min-height:100%; }
.view.active { display:block; }

/* View header */
.view-header {
  display:flex; align-items:center; justify-content:space-between;
  flex-wrap:wrap; gap:14px; margin-bottom:30px;
}
.view-header h2 { font-family:var(--font-d); font-size:24px; font-weight:800; letter-spacing:-.4px; }

/* ─── Buttons ────────────────────────────────────────────────────── */
.accent-btn {
  display:inline-flex; align-items:center; gap:6px; padding:9px 18px;
  border-radius:20px; background:var(--accent); color:#000;
  font-weight:700; font-size:13.5px; transition:var(--t); white-space:nowrap;
}
.accent-btn:hover { filter:brightness(1.1); transform:scale(1.02); }
.ghost-btn {
  display:inline-flex; align-items:center; gap:6px; padding:8px 15px;
  border-radius:20px; font-size:13.5px; font-weight:500;
  background:rgba(255,255,255,0.06); border:1px solid var(--border);
  color:var(--text-2); transition:var(--t); white-space:nowrap;
}
.ghost-btn:hover { background:rgba(255,255,255,0.11); color:var(--text-1); }
.ghost-btn.danger:hover { background:rgba(229,83,75,.15); color:#e5534b; border-color:rgba(229,83,75,.3); }
.back-btn {
  display:inline-flex; align-items:center; gap:6px; margin-bottom:18px;
  padding:7px 14px; border-radius:20px; font-size:13px;
  color:var(--text-2); background:var(--bg-2); border:1px solid var(--border); transition:var(--t);
}
.back-btn:hover { color:var(--text-1); }

/* Toggle */
.toggle-label { display:inline-flex; align-items:center; gap:10px; cursor:pointer; }
.toggle-label input { display:none; }
.toggle {
  position:relative; width:40px; height:22px;
  background:var(--bg-3); border-radius:11px; border:1px solid var(--border); transition:var(--t); flex-shrink:0;
}
.toggle::after {
  content:''; position:absolute; top:3px; left:3px;
  width:14px; height:14px; border-radius:50%; background:var(--text-3); transition:var(--t);
}
.toggle-label input:checked ~ .toggle { background:var(--accent); border-color:var(--accent); }
.toggle-label input:checked ~ .toggle::after { left:21px; background:#000; }

/* Tabs */
.lib-tabs { display:flex; gap:3px; }
.lib-tab {
  padding:7px 15px; border-radius:20px; font-size:13px; font-weight:500;
  color:var(--text-3); border:1px solid transparent; transition:var(--t);
}
.lib-tab:hover  { color:var(--text-2); background:var(--bg-2); }
.lib-tab.active { color:var(--text-1); background:var(--bg-2); border-color:var(--border); }

/* ─── HOME ───────────────────────────────────────────────────────── */
/* Greeting */
.home-greeting { margin-bottom:24px; }
.home-greeting-text {
  font-family:var(--font-d); font-size:28px; font-weight:800;
  letter-spacing:-.6px; line-height:1.2;
}
.home-greeting-text .accent { color:var(--accent); }
.home-greeting-sub { color:var(--text-3); font-size:13.5px; margin-top:6px; }

/* Action row */
.home-actions { display:flex; align-items:center; gap:9px; flex-wrap:wrap; margin-bottom:32px; }

/* ─── Today Mix card ─────────────────────────────────────────────── */
.today-mix-card {
  background: linear-gradient(135deg, color-mix(in srgb, var(--accent) 14%, #080808) 0%, #0a0a0a 100%);
  border: 1px solid rgba(var(--accent-rgb),.2);
  border-radius: var(--r4); padding: 26px 28px;
  display: flex; align-items: center; gap: 24px;
  margin-bottom: 32px; position: relative; overflow: hidden;
  cursor: pointer; transition: var(--t);
}
.today-mix-card::before {
  content: ''; position: absolute; top: -60px; right: -40px;
  width: 260px; height: 260px; border-radius: 50%;
  background: radial-gradient(circle, rgba(var(--accent-rgb),.14) 0%, transparent 68%);
  pointer-events: none;
}
.today-mix-card::after {
  content: ''; position: absolute; bottom: -30px; left: 60px;
  width: 120px; height: 120px; border-radius: 50%;
  background: radial-gradient(circle, rgba(var(--accent-rgb),.07) 0%, transparent 70%);
  pointer-events: none;
}
.today-mix-card:hover {
  border-color: rgba(var(--accent-rgb),.38);
  transform: translateY(-2px);
  box-shadow: 0 16px 48px rgba(0,0,0,.55);
}

/* 2×2 mosaic art */
.today-mix-mosaic {
  width: 90px; height: 90px; border-radius: 14px; flex-shrink: 0;
  display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr;
  gap: 2px; overflow: hidden;
  box-shadow: 0 8px 24px rgba(0,0,0,.5);
}
.today-mix-mosaic img { width: 100%; height: 100%; object-fit: cover; display: block; }
.today-mix-icon {
  width: 90px; height: 90px; border-radius: 14px; flex-shrink: 0;
  background: linear-gradient(135deg, rgba(var(--accent-rgb),.35), rgba(var(--accent-rgb),.08));
  display: flex; align-items: center; justify-content: center; font-size: 36px;
  box-shadow: 0 8px 24px rgba(0,0,0,.4);
}
.today-mix-info { flex: 1; min-width: 0; }
.today-mix-label {
  font-size: 10px; font-weight: 700; letter-spacing: 2.5px;
  color: var(--accent); text-transform: uppercase; margin-bottom: 6px;
}
.today-mix-title {
  font-family: var(--font-d); font-size: 22px; font-weight: 800;
  line-height: 1.15; letter-spacing: -.3px;
}
.today-mix-sub { font-size: 13px; color: var(--text-3); margin-top: 5px; }
.today-mix-play-btn {
  width: 50px; height: 50px; border-radius: 50%; flex-shrink: 0;
  background: var(--accent);
  display: flex; align-items: center; justify-content: center;
  transition: var(--t); box-shadow: 0 6px 20px rgba(var(--accent-rgb),.4);
}
.today-mix-play-btn:hover { transform: scale(1.1); box-shadow: 0 8px 28px rgba(var(--accent-rgb),.55); }
.today-mix-play-btn svg { width: 18px; height: 18px; fill: #000; stroke: none; margin-left: 3px; }

/* ─── Section titles ─────────────────────────────────────────────── */
.section-hd { display:flex; align-items:baseline; gap:9px; margin-bottom:15px; }
.section-title {
  font-family:var(--font-d); font-size:18px; font-weight:700; letter-spacing:-.2px;
}
.count-badge {
  font-size:11.5px; color:var(--text-3); background:var(--bg-2);
  padding:1px 8px; border-radius:9px; border:1px solid var(--border);
}
.home-section { margin-bottom:var(--section-mb); }

/* ─── Card row ───────────────────────────────────────────────────── */
.card-row { display:flex; gap:var(--card-gap); overflow-x:auto; padding-bottom:8px; }
.card-row::-webkit-scrollbar { height:3px; }

/* ─── Track card ─────────────────────────────────────────────────── */
.track-card {
  flex-shrink:0; width:162px; border-radius:var(--r3);
  background:var(--bg-2); cursor:pointer; transition:var(--t); overflow:hidden;
}
.track-card:hover { background:var(--bg-3); transform:translateY(-4px);
  box-shadow:0 14px 36px rgba(0,0,0,.55); }
.track-card.playing { background:rgba(var(--accent-rgb),.1); }
.track-card.playing .card-title { color:var(--accent); }

.card-art { width:100%; aspect-ratio:1; position:relative; overflow:hidden; background:var(--bg); }
.card-art img { width:100%; height:100%; object-fit:cover; transition:transform .4s var(--ease); }
.track-card:hover .card-art img { transform:scale(1.05); }
.card-art-ph {
  width:100%; height:100%; display:flex; align-items:center; justify-content:center;
  background:linear-gradient(135deg,var(--bg-1),var(--bg-2));
}
.card-art-ph svg { width:36px; height:36px; stroke:var(--text-3); stroke-width:1.2; }

.card-play-btn {
  position:absolute; bottom:9px; right:9px;
  width:36px; height:36px; border-radius:50%;
  background:var(--accent); color:#000; display:flex; align-items:center; justify-content:center;
  opacity:0; transform:translateY(6px) scale(.88); transition:var(--t);
  box-shadow:0 4px 16px rgba(0,0,0,.6);
}
.card-play-btn svg { width:13px; height:13px; fill:#000; stroke:none; margin-left:2px; }
.track-card:hover .card-play-btn { opacity:1; transform:none; }

.card-info { padding:13px 14px 16px; }
.card-title  { font-size:13.5px; font-weight:600; line-height:1.35;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.card-artist { font-size:12px; color:var(--text-3); margin-top:3px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.card-count  { font-size:11px; color:var(--accent); margin-top:4px; font-weight:700; }

/* ─── Track list ─────────────────────────────────────────────────── */
.track-list { width:100%; }
.track-rows { display:flex; flex-direction:column; gap:1px; }
.track-list-header {
  display:grid;
  grid-template-columns:40px 54px 1fr 200px 80px 76px;
  gap:12px; padding:4px 14px 12px;
  border-bottom:1px solid var(--border); margin-bottom:6px;
}
.track-list-header span { font-size:10.5px; letter-spacing:1.5px; text-transform:uppercase;
  color:var(--text-3); font-weight:700; }
.th-dur,.track-dur { text-align:right; }

.track-item {
  display:grid;
  grid-template-columns:40px 54px 1fr 200px 80px 76px;
  align-items:center; gap:12px; padding:10px 14px;
  border-radius:var(--r2); cursor:pointer; transition:var(--t);
  min-height:var(--track-item-h);
  color:var(--text-2);
}
.track-item:hover { background:var(--bg-3); color:var(--text-1); }
.track-item:hover .track-actions { opacity:1; }
.track-item.active { background:rgba(var(--accent-rgb),.08); }
.track-item.active .track-name { color:var(--accent); }

.track-num { font-size:13px; color:var(--text-3); text-align:center; }
.track-art-sm { width:44px; height:44px; border-radius:6px; overflow:hidden; background:var(--bg-1); flex-shrink:0; }
.track-art-sm img { width:100%; height:100%; object-fit:cover; }
.art-ph { width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:var(--bg-1); }
.art-ph svg { width:18px; height:18px; stroke:var(--text-3); stroke-width:1.5; }

.track-main { min-width:0; }
.track-name { font-size:14px; font-weight:500; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; line-height:1.4; }
.track-by   { font-size:12.5px; color:var(--text-3); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top:2px; }
.track-album { font-size:13px; color:var(--text-3); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.track-dur   { font-size:13px; color:var(--text-3); font-variant-numeric:tabular-nums; }

.track-actions { display:flex; justify-content:flex-end; gap:4px; opacity:0; transition:var(--t); }
.track-action-btn {
  width:28px; height:28px; border-radius:var(--r1); font-size:13px;
  background:rgba(255,255,255,0.07); color:var(--text-3); transition:var(--t);
  display:flex; align-items:center; justify-content:center;
}
.track-action-btn:hover { background:var(--accent); color:#000; }

/* Playing bars */
.bars { display:flex; align-items:flex-end; gap:2px; height:15px; justify-content:center; }
.bars span { display:block; width:3px; background:var(--accent); border-radius:1px; animation:bounce .7s ease-in-out infinite alternate; }
.bars span:nth-child(1) { height:7px;  animation-delay:0s;    }
.bars span:nth-child(2) { height:15px; animation-delay:.15s; }
.bars span:nth-child(3) { height:9px;  animation-delay:.3s;  }
@keyframes bounce { from{transform:scaleY(.3)} to{transform:scaleY(1)} }

/* ─── Side panel ─────────────────────────────────────────────────── */
#side-panel {
  width:var(--side-w); flex-shrink:0; display:flex; flex-direction:column;
  background:rgba(8,8,8,.65); border-left:1px solid var(--border); overflow:hidden;
}
#viz-wrap { position:relative; aspect-ratio:1; overflow:hidden; flex-shrink:0; }
#visualizer { position:absolute; inset:0; width:100%; height:100%; }
.side-art { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; }
.side-art-img { width:100%; height:100%; }
.side-art-img img { width:100%; height:100%; object-fit:cover; }
.side-art-ph { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; }
.side-art-ph svg { width:56px; height:56px; stroke:var(--text-3); stroke-width:1; }
.side-info { padding:16px 16px 12px; }
.side-title  { font-family:var(--font-d); font-size:14.5px; font-weight:700; line-height:1.3; }
.side-artist { font-size:12.5px; color:var(--text-3); margin-top:4px; }
.side-album  { font-size:12px; color:var(--text-3); margin-top:2px; font-style:italic; }

/* ─── Player bar ─────────────────────────────────────────────────── */
/* ═══════════════════════════════════════════════════════
   PLAYER BAR — redesigned for space, clarity, UX
   ═══════════════════════════════════════════════════════ */
#player-bar {
  display:flex; flex-direction:column;
  padding:0; background:var(--pb-bg, rgba(10,10,10,.98));
  border-top:1px solid var(--border);
  backdrop-filter:blur(32px) saturate(1.4);
  flex-shrink:0; z-index:50;
}

/* ── Top: full-width seek strip ──────────────────────── */
.pb-seek-row {
  display:flex; align-items:center; gap:14px;
  padding:12px 28px 4px;
  width:100%; box-sizing:border-box;
}
.pb-time {
  font-size:11.5px; color:var(--text-3); font-variant-numeric:tabular-nums;
  white-space:nowrap; min-width:34px; flex-shrink:0;
  font-weight:500; letter-spacing:.3px;
}
.pb-time-r { text-align:right; }
.pb-seek-wrap {
  flex:1; position:relative; height:20px;
  display:flex; align-items:center; cursor:pointer;
}
.pb-seek-bg {
  position:absolute; left:0; right:0; height:4px;
  background:rgba(255,255,255,.1); border-radius:4px;
}
.pb-seek-fill {
  position:absolute; left:0; height:4px;
  background:var(--accent); border-radius:4px;
  transition:width .1s linear; pointer-events:none;
  width:0%;
}
.pb-seek-thumb {
  position:absolute; top:50%; width:14px; height:14px;
  border-radius:50%; background:#fff; margin-left:-7px;
  transform:translateY(-50%) scale(0);
  transition:transform .15s var(--ease);
  pointer-events:none; box-shadow:0 1px 4px rgba(0,0,0,.5);
}
.pb-seek-wrap:hover .pb-seek-thumb { transform:translateY(-50%) scale(1); }
.pb-seek-wrap:hover .pb-seek-bg { background:rgba(255,255,255,.18); }
.pb-seek-wrap:hover .pb-seek-fill { filter:brightness(1.15); }

/* ── Main row ────────────────────────────────────────── */
.pb-main {
  display:flex; align-items:center;
  padding:10px 28px 14px; gap:0;
}

/* ── LEFT: art + info ────────────────────────────────── */
.player-left {
  display:flex; align-items:center; gap:14px;
  width:300px; min-width:0; flex-shrink:0;
}
.player-art {
  width:52px; height:52px; border-radius:10px; overflow:hidden;
  background:var(--bg-2); flex-shrink:0;
  box-shadow:0 4px 16px rgba(0,0,0,.5);
}
.player-art img, .player-art .art-ph { width:100%; height:100%; object-fit:cover; }
.player-info { min-width:0; flex:1; }
.player-title  { font-size:14px; font-weight:600; color:var(--text-1); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; line-height:1.3; }
.player-artist { font-size:12.5px; color:var(--text-3); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top:3px; }

/* Icon buttons in player bar */
.pb-icon-btn {
  width:36px; height:36px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  color:var(--text-3); transition:var(--t); flex-shrink:0;
  background:transparent;
}
.pb-icon-btn svg { width:17px; height:17px; stroke:currentColor; fill:none; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; }
.pb-icon-btn:hover { color:var(--text-1); background:rgba(255,255,255,.08); }
.pb-icon-btn.active { color:var(--accent); }
#btn-like svg { transition:fill .15s, color .15s; }
#btn-like.liked { color:var(--accent); }
#btn-like.liked svg { fill:var(--accent); }

/* ── CENTER: transport ───────────────────────────────── */
.player-center { flex:1; display:flex; justify-content:center; }
.pb-controls { display:flex; align-items:center; gap:6px; }

.pb-ctrl-sm {
  width:38px; height:38px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  color:var(--text-3); transition:var(--t);
}
.pb-ctrl-sm svg { width:16px; height:16px; stroke:currentColor; fill:none; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; }
.pb-ctrl-sm:hover { color:var(--text-1); background:rgba(255,255,255,.08); }
.pb-ctrl-sm.active { color:var(--accent); }

.pb-ctrl {
  width:44px; height:44px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  color:var(--text-2); transition:var(--t);
}
.pb-ctrl svg { width:20px; height:20px; stroke:currentColor; fill:none; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; }
.pb-ctrl:hover { color:var(--text-1); background:rgba(255,255,255,.1); }

.pb-play {
  width:54px; height:54px; border-radius:50%;
  background:var(--text-1); color:#000;
  display:flex; align-items:center; justify-content:center;
  transition:transform .15s var(--ease), box-shadow .15s;
  box-shadow:0 4px 20px rgba(0,0,0,.4);
  flex-shrink:0; margin:0 4px;
}
.pb-play svg { width:20px; height:20px; stroke:none; fill:currentColor; }
.pb-play:hover { transform:scale(1.08); box-shadow:0 6px 28px rgba(0,0,0,.5); }
.pb-play:active { transform:scale(.96); }

/* ── RIGHT: volume + extras ──────────────────────────── */
.player-right {
  display:flex; align-items:center; gap:8px;
  width:300px; justify-content:flex-end; flex-shrink:0;
}
.pb-vol { display:flex; align-items:center; gap:8px; }
.pb-vol-slider-wrap {
  position:relative; width:90px; height:20px;
  display:flex; align-items:center;
}
.pb-vol-slider-wrap input[type=range] {
  width:100%; appearance:none; -webkit-appearance:none;
  height:4px; border-radius:4px; outline:none;
  background:rgba(255,255,255,.12); cursor:pointer;
  position:relative; z-index:2;
}
.pb-vol-slider-wrap input[type=range]::-webkit-slider-thumb {
  -webkit-appearance:none; width:14px; height:14px;
  border-radius:50%; background:#fff; cursor:pointer;
  box-shadow:0 1px 4px rgba(0,0,0,.4);
}
.pb-speed-btn {
  font-size:12px; font-weight:700; color:var(--text-3);
  padding:0 10px; width:auto; border-radius:6px;
  background:rgba(255,255,255,.06); border:1px solid var(--border);
  height:32px; letter-spacing:.3px;
}
.pb-speed-btn:hover { color:var(--text-1); background:rgba(255,255,255,.12); }

/* ── Legacy aliases so JS selectors still work ───────── */
#seek-fill  { /* mapped to .pb-seek-fill */ }
#seek-thumb { /* mapped to .pb-seek-thumb */ }

input[type=range] {
  -webkit-appearance:none; height:3px; background:rgba(255,255,255,.14); border-radius:2px; outline:none; cursor:pointer;
}
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance:none; width:13px; height:13px; border-radius:50%;
  background:#fff; cursor:pointer; box-shadow:0 1px 4px rgba(0,0,0,.4);
}
#vol-slider { width:82px; }

/* Speed popup */
.popup {
  position:fixed; background:var(--bg-2); border:1px solid var(--border-2);
  border-radius:var(--r2); padding:15px 18px;
  box-shadow:0 16px 48px rgba(0,0,0,.7); z-index:200;
  display:flex; flex-direction:column; gap:9px; min-width:170px;
}
.popup-title { font-size:12.5px; font-weight:600; color:var(--text-2); }

/* Context menu */
.ctx-menu {
  position:fixed; background:var(--bg-2); border:1px solid var(--border-2);
  border-radius:var(--r2); padding:5px;
  box-shadow:0 16px 48px rgba(0,0,0,.7); z-index:300; min-width:185px;
}
.ctx-item { padding:9px 13px; border-radius:var(--r1); font-size:13.5px; cursor:pointer; transition:var(--t); color:var(--text-2); }
.ctx-item:hover { background:var(--bg-3); color:var(--text-1); }
.ctx-item.danger:hover { background:rgba(229,83,75,.14); color:#e5534b; }
.ctx-sep { height:1px; background:var(--border); margin:4px 7px; }

/* Modal */
#modal-overlay {
  position:fixed; inset:0; background:rgba(0,0,0,.72);
  display:flex; align-items:center; justify-content:center;
  z-index:400; backdrop-filter:blur(10px);
}
#modal {
  background:var(--bg-2); border:1px solid var(--border-2);
  border-radius:var(--r4); padding:26px; min-width:340px; max-width:460px; width:90%;
  box-shadow:0 24px 60px rgba(0,0,0,.8);
}
#modal-title { font-family:var(--font-d); font-size:17px; font-weight:700; margin-bottom:14px; }
#modal-body  { font-size:14px; color:var(--text-2); line-height:1.6; margin-bottom:18px; }
#modal-body p { margin-bottom:9px; }
#modal-body input,#modal-body select {
  width:100%; padding:10px 13px; background:var(--bg-1);
  border:1px solid var(--border); border-radius:var(--r1);
  font-size:14px; margin-top:7px; outline:none; transition:var(--t);
}
#modal-body input:focus,#modal-body select:focus { border-color:var(--accent); }
#modal-actions { display:flex; gap:9px; justify-content:flex-end; }

/* Toast */
#toast-box {
  position:fixed; bottom:calc(var(--player-h) + 14px); left:50%; transform:translateX(-50%);
  display:flex; flex-direction:column; align-items:center; gap:7px;
  z-index:500; pointer-events:none;
}
.toast {
  background:rgba(28,28,28,.97); border:1px solid var(--border-2);
  color:var(--text-1); font-size:13.5px; font-weight:500;
  padding:9px 18px; border-radius:18px;
  box-shadow:0 8px 26px rgba(0,0,0,.6); backdrop-filter:blur(12px);
  animation:toast-in .26s var(--ease);
}
.toast.fade-out { opacity:0; transition:opacity .26s; }
@keyframes toast-in { from{opacity:0;transform:translateY(10px) scale(.95)} to{opacity:1;transform:none} }

/* Drop zone */
.drop-zone {
  border:2px dashed var(--border-2); border-radius:var(--r4);
  padding:54px 28px; text-align:center; cursor:pointer;
  transition:var(--t); margin-bottom:28px;
  display:flex; flex-direction:column; align-items:center; gap:12px;
}
.drop-zone:hover { border-color:var(--accent); background:rgba(var(--accent-rgb),.04); }
.drop-zone svg { width:40px; height:40px; stroke:var(--text-3); }
.drop-zone p     { font-size:15px; font-weight:500; color:var(--text-2); }
.drop-zone small { font-size:13px; color:var(--text-3); }

/* Empty state */
.empty { padding:60px 24px; text-align:center; color:var(--text-3); font-size:14px; }

/* Grids */
.artists-grid,.albums-grid,.genres-grid,.pls-grid {
  display:grid; grid-template-columns:repeat(auto-fill,minmax(155px,1fr)); gap:16px;
}
.artist-card,.album-card,.genre-card,.pl-card {
  background:var(--bg-2); border-radius:var(--r3);
  overflow:hidden; cursor:pointer; transition:var(--t); text-align:center;
}
.artist-card:hover,.album-card:hover,.genre-card:hover,.pl-card:hover {
  background:var(--bg-3); transform:translateY(-4px); box-shadow:0 14px 34px rgba(0,0,0,.5);
}
.artist-ava,.album-cov,.genre-art,.pl-cov {
  width:100%; aspect-ratio:1; background:var(--bg-1);
  display:flex; align-items:center; justify-content:center; overflow:hidden;
}
.artist-ava img,.album-cov img,.genre-art img,.pl-cov img { width:100%; height:100%; object-fit:cover; }
.artist-ava svg,.album-cov svg,.genre-art svg,.pl-cov svg { width:38px; height:38px; stroke:var(--text-3); stroke-width:1.2; }
.artist-ava { border-radius:50%; width:76%; aspect-ratio:1; margin:13px auto 0; }
.card-name { font-size:13px; font-weight:600; padding:9px 11px 2px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.card-sub  { font-size:11.5px; color:var(--text-3); padding:0 11px 11px; }

/* ─── Playlist page section headers ─────────────────────────────── */
.pls-section-hd {
  font-family: var(--font-d); font-size: 13px; font-weight: 700;
  letter-spacing: .5px; text-transform: uppercase;
  color: var(--text-3); margin-bottom: 14px; margin-top: 28px;
  padding-bottom: 8px; border-bottom: 1px solid var(--border);
}
.pls-section-hd:first-child { margin-top: 0; }
.pls-empty-hint {
  font-size: 13px; color: var(--text-3); padding: 16px 4px; opacity: .6;
}

/* Smart playlist card — slightly different art treatment */
.smart-pl .pl-cov {
  background: var(--bg-1);
}
/* Mosaic cover (2×2 grid of album arts) inside any pl-card */
.pl-cov-mosaic {
  width: 100%; aspect-ratio: 1;
  display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr;
  gap: 2px; overflow: hidden;
}
.pl-cov-mosaic img { width: 100%; height: 100%; object-fit: cover; display: block; }
/* Icon-only cover (no artwork) */
.pl-cov-icon {
  width: 100%; aspect-ratio: 1;
  display: flex; align-items: center; justify-content: center;
  font-size: 32px;
  background: linear-gradient(135deg, var(--bg-3) 0%, var(--bg-1) 100%);
}
.pl-cov-icon svg {
  width: 36px; height: 36px;
  stroke: var(--text-3); fill: none; stroke-width: 1.5;
  stroke-linecap: round; stroke-linejoin: round;
}
/* Accent color tint for smart playlist icons */
.smart-pl .pl-cov-icon {
  background: linear-gradient(135deg,
    color-mix(in srgb, var(--pl-color, var(--accent)) 18%, var(--bg-2)) 0%,
    var(--bg-1) 100%);
}
.smart-pl .pl-cov-icon svg {
  stroke: var(--pl-color, var(--accent));
  opacity: .85;
}

/* Equalizer */
#eq-panel { max-width:680px; }
.eq-hd { display:flex; align-items:center; gap:18px; margin-bottom:26px; flex-wrap:wrap; }
.eq-hd select { padding:7px 13px; background:var(--bg-2); border:1px solid var(--border); border-radius:var(--r1); font-size:13.5px; cursor:pointer; outline:none; }
.eq-bands { display:flex; gap:12px; align-items:flex-end; height:155px; margin-bottom:26px; }
.eq-band { display:flex; flex-direction:column; align-items:center; gap:7px; flex:1; }
.eq-band > span { font-size:10.5px; color:var(--text-3); white-space:nowrap; }
.eq-band label  { font-size:10.5px; color:var(--text-3); }
.eq-band input[type=range] { writing-mode:vertical-lr; direction:rtl; width:4px; height:100px; appearance:slider-vertical; }
.eq-extra { display:flex; flex-direction:column; gap:14px; }
.eq-ctrl  { display:flex; align-items:center; gap:12px; }
.eq-ctrl label { font-size:13.5px; color:var(--text-2); width:115px; }
.eq-ctrl input[type=range] { flex:1; }
.eq-ctrl span { font-size:13px; color:var(--text-3); width:50px; text-align:right; }

/* Settings */
#settings-panel { max-width:580px; display:flex; flex-direction:column; gap:22px; }
.settings-sec { background:var(--bg-2); border-radius:var(--r3); padding:24px 26px; border:1px solid var(--border); }
.settings-sec h3 { font-family:var(--font-d); font-size:13.5px; font-weight:700; letter-spacing:.3px; margin-bottom:18px; color:var(--text-2); }
.setting-row { display:flex; align-items:center; justify-content:space-between; gap:16px; padding:14px 0; border-bottom:1px solid var(--border); }
.setting-row:last-child { border-bottom:none; padding-bottom:0; }
.setting-row > label:first-child { font-size:14.5px; color:var(--text-2); flex-shrink:0; line-height:1.6; }
.setting-row input[type=range] { flex:1; max-width:190px; }
.setting-row > span { font-size:13px; color:var(--text-3); white-space:nowrap; }
.num-input { width:68px; padding:6px 10px; background:var(--bg-1); border:1px solid var(--border); border-radius:var(--r1); font-size:13.5px; text-align:center; }
.folder-item {
  display:flex; align-items:center; justify-content:space-between;
  padding:8px 11px; border-radius:var(--r1); background:var(--bg-1);
  margin-bottom:6px; font-size:13px; color:var(--text-2); border:1px solid var(--border);
}
.folder-item span { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.folder-rm { color:var(--text-3); transition:var(--t); flex-shrink:0; font-size:12px; padding:2px 5px; }
.folder-rm:hover { color:#e5534b; }
.shortcuts-grid { display:flex; flex-direction:column; }
.shortcut-row { display:flex; justify-content:space-between; align-items:center; padding:9px 0; border-bottom:1px solid var(--border); font-size:14px; color:var(--text-2); }
.shortcut-row:last-child { border-bottom:none; }

/* ── About / Ownership tile ─────────────────────────────────────── */
.about-tile {
  margin-top: 10px;
  background: linear-gradient(135deg,
    color-mix(in srgb, var(--accent) 8%, var(--bg-2)) 0%,
    var(--bg-2) 100%) !important;
  border: 1px solid rgba(var(--accent-rgb), .18) !important;
  border-radius: var(--r3);
  padding: 22px 24px !important;
}
.about-inner {
  display: flex; align-items: center; gap: 16px;
  margin-bottom: 20px;
  padding-bottom: 18px;
  border-bottom: 1px solid var(--border);
}
.about-logo svg { width: 42px; height: 42px; flex-shrink: 0; }
.about-app {
  font-family: var(--font-d); font-size: 20px; font-weight: 800;
  letter-spacing: -.4px; line-height: 1;
}
.about-version {
  font-size: 12px; font-weight: 500; color: var(--text-3);
  vertical-align: middle; margin-left: 4px;
}
.about-tagline {
  font-size: 12.5px; color: var(--text-3); margin-top: 4px; font-style: italic;
}
.about-credits { display: flex; flex-direction: column; gap: 10px; }
.about-credit-row {
  display: flex; align-items: center; gap: 0;
}
.about-credit-label {
  font-size: 11.5px; font-weight: 600; letter-spacing: .3px;
  color: var(--text-3); text-transform: uppercase;
  min-width: 90px; flex-shrink: 0;
}
.about-credit-val {
  font-size: 13.5px; color: var(--text-1);
}
.about-credit-link {
  font-size: 13.5px; color: var(--accent);
  text-decoration: none; border-bottom: 1px solid rgba(var(--accent-rgb), .3);
  transition: border-color .15s ease, opacity .15s ease;
}
.about-credit-link:hover {
  opacity: .8; border-bottom-color: var(--accent);
}
kbd { background:var(--bg-1); border:1px solid var(--border); border-radius:5px; padding:3px 8px; font-size:11.5px; font-family:monospace; color:var(--text-1); }

/* Track info */
.track-info-grid { display:grid; grid-template-columns:1fr 1fr; gap:9px; }
.ti-row { display:flex; flex-direction:column; gap:2px; }
.ti-row .lbl { font-size:10.5px; letter-spacing:1.5px; text-transform:uppercase; color:var(--text-3); font-weight:700; }
.ti-row .val { font-size:13.5px; color:var(--text-1); }

/* ══════════════════════════════════════════════════════════════════
   NOW PLAYING FULLSCREEN
   ══════════════════════════════════════════════════════════════════ */
/* ══════════════════════════════════════════════════════════════════
   NOW PLAYING — fullscreen overlay
   Layout: topbar / body(left col + right queue panel)
   ══════════════════════════════════════════════════════════════════ */
#now-playing {
  position: fixed; inset: 0; z-index: 350;
  display: flex; flex-direction: column;
  overflow: hidden;
  background: #0a0a0a;  /* solid dark base — never transparent */
}
#now-playing.hidden { display: none; }

/* Blurred album art backdrop */
#np-bg {
  position: absolute; inset: -10%; z-index: 0;
  background-size: cover; background-position: center;
  filter: blur(80px) saturate(1.8) brightness(0.22);
  transition: background-image .9s ease;
  pointer-events: none;
}
#np-bg::after {
  content: ''; position: absolute; inset: 0;
  background: rgba(0,0,0,.55);
  pointer-events: none;
}

/* ── Topbar ── */
.np-topbar {
  position: relative; z-index: 2;
  padding: 20px 28px 0;
  display: flex; align-items: center;
  flex-shrink: 0;
}
.np-close {
  display: inline-flex; align-items: center; gap: 7px;
  color: rgba(255,255,255,.4); cursor: pointer;
  font-size: 13px; letter-spacing: .2px;
  transition: color .15s ease;
}
.np-close svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2.2; stroke-linecap: round; }
.np-close:hover { color: rgba(255,255,255,.85); }

/* ── Body ── */
.np-body {
  position: relative; z-index: 1;
  flex: 1; min-height: 0;
  display: flex; gap: 0;
  padding: 28px 36px 28px;
}

/* ══════════════════════════════
   LEFT COLUMN — art + controls
   ══════════════════════════════ */
.np-left {
  flex: 1; min-width: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  gap: 22px;
  padding-right: 36px;
}

/* Album art */
.np-art-wrap { position: relative; flex-shrink: 0; }
.np-art {
  width: clamp(180px, 28vw, 320px);
  height: clamp(180px, 28vw, 320px);
  border-radius: 18px; overflow: hidden;
  background: rgba(255,255,255,.06);
  box-shadow: 0 32px 80px rgba(0,0,0,.75), 0 0 0 1px rgba(255,255,255,.07);
}
.np-art img { width: 100%; height: 100%; object-fit: cover; display: block; }
.np-art.np-art-playing { animation: np-breathe 4s ease-in-out infinite alternate; }
@keyframes np-breathe {
  from { transform: scale(1);     box-shadow: 0 32px 80px rgba(0,0,0,.75); }
  to   { transform: scale(1.022); box-shadow: 0 44px 100px rgba(0,0,0,.85); }
}
.np-art-shadow {
  position: absolute; bottom: -18px; left: 10%; right: 10%; height: 28px;
  background: rgba(0,0,0,.5); filter: blur(18px); border-radius: 50%;
  pointer-events: none;
}

/* Track info */
.np-track-info {
  text-align: center; width: 100%;
  max-width: clamp(180px, 28vw, 360px);
}
.np-title {
  font-family: var(--font-d); font-size: clamp(16px, 2.2vw, 26px);
  font-weight: 800; line-height: 1.15; letter-spacing: -.4px; color: #fff;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.np-artist {
  font-size: 14px; color: rgba(255,255,255,.55); margin-top: 5px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.np-album {
  font-size: 12.5px; color: rgba(255,255,255,.3); margin-top: 3px;
  font-style: italic; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* Like + shuffle row */
.np-meta-row {
  display: flex; align-items: center; gap: 8px;
}
.np-icon-btn {
  width: 40px; height: 40px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  color: rgba(255,255,255,.4); transition: color .15s ease, background .15s ease;
}
.np-icon-btn svg { width: 18px; height: 18px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
.np-icon-btn:hover { color: rgba(255,255,255,.9); background: rgba(255,255,255,.1); }
.np-icon-btn.active, .np-icon-btn.liked { color: var(--accent); }
.np-icon-btn.liked svg { fill: var(--accent); stroke: var(--accent); }

/* Seek bar */
.np-seek-row {
  display: flex; align-items: center; gap: 12px;
  width: 100%; max-width: clamp(180px, 28vw, 380px);
}
.np-seek-row span {
  font-size: 11px; color: rgba(255,255,255,.38);
  font-variant-numeric: tabular-nums; min-width: 34px;
}
.np-seek-row span:last-child { text-align: right; }
.np-seek-wrap {
  flex: 1; height: 20px; display: flex; align-items: center;
  position: relative; cursor: pointer;
}
.np-seek-track {
  position: absolute; inset: 0; margin: auto;
  height: 3px; background: rgba(255,255,255,.15); border-radius: 3px;
}
.np-seek-fill {
  position: absolute; left: 0; top: 50%; transform: translateY(-50%);
  height: 3px; background: #fff; border-radius: 3px;
  transition: width .1s linear; width: 0%; pointer-events: none;
}
.np-seek-thumb {
  position: absolute; top: 50%; transform: translateY(-50%) scale(0);
  width: 14px; height: 14px; border-radius: 50%; background: #fff;
  margin-left: -7px; transition: transform .15s ease; pointer-events: none;
}
.np-seek-wrap:hover .np-seek-thumb  { transform: translateY(-50%) scale(1); }
.np-seek-wrap:hover .np-seek-track  { background: rgba(255,255,255,.28); }

/* Transport controls */
.np-controls {
  display: flex; align-items: center; gap: 8px;
}
.np-ctrl {
  width: 50px; height: 50px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  color: rgba(255,255,255,.6); transition: color .15s, background .15s;
}
.np-ctrl svg { width: 22px; height: 22px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
.np-ctrl:hover { color: #fff; background: rgba(255,255,255,.1); }
.np-play-btn {
  width: 66px; height: 66px; border-radius: 50%;
  background: #fff; color: #000; margin: 0 8px;
  display: flex; align-items: center; justify-content: center;
  transition: transform .15s ease, box-shadow .15s;
  box-shadow: 0 8px 28px rgba(0,0,0,.5);
  flex-shrink: 0;
}
.np-play-btn:hover { transform: scale(1.08); box-shadow: 0 12px 36px rgba(0,0,0,.65); }
.np-play-btn:active { transform: scale(.95); }
.np-play-btn svg { width: 24px; height: 24px; fill: #000; stroke: none; }
#np-play-icon  { margin-left: 2px; }

/* Volume */
.np-vol-row {
  display: flex; align-items: center; gap: 10px;
  width: 100%; max-width: clamp(180px, 22vw, 280px);
}
.np-vol-icon { width: 14px; height: 14px; flex-shrink: 0; fill: none; stroke: rgba(255,255,255,.32); stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
.np-vol-slider {
  flex: 1; -webkit-appearance: none; appearance: none;
  height: 3px; border-radius: 3px; outline: none; cursor: pointer;
  background: rgba(255,255,255,.2);
}
.np-vol-slider::-webkit-slider-thumb {
  -webkit-appearance: none; width: 13px; height: 13px;
  border-radius: 50%; background: #fff; cursor: pointer;
  box-shadow: 0 1px 4px rgba(0,0,0,.4);
}

/* ══════════════════════════════
   RIGHT COLUMN — queue panel
   ══════════════════════════════ */
.np-right {
  width: 280px; flex-shrink: 0;
  display: flex; flex-direction: column;
  background: rgba(255,255,255,.06);
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.1);
  overflow: hidden;
}
.np-queue-hd {
  display: flex; align-items: center; justify-content: space-between;
  padding: 18px 18px 14px; flex-shrink: 0;
  font-family: var(--font-d); font-size: 12px; font-weight: 700;
  letter-spacing: .5px; text-transform: uppercase;
  color: rgba(255,255,255,.4);
  border-bottom: 1px solid rgba(255,255,255,.07);
}
.np-queue-count {
  font-size: 11px; font-weight: 500; letter-spacing: 0;
  background: rgba(255,255,255,.08); color: rgba(255,255,255,.35);
  padding: 2px 8px; border-radius: 20px; text-transform: none;
}
.np-queue { flex: 1; overflow-y: auto; padding: 6px 0; }
.np-queue::-webkit-scrollbar { width: 3px; }
.np-queue::-webkit-scrollbar-thumb { background: rgba(255,255,255,.1); border-radius: 2px; }
.np-qi {
  display: flex; align-items: center; gap: 11px;
  padding: 9px 16px; cursor: pointer;
  transition: background .12s ease;
}
.np-qi:hover { background: rgba(255,255,255,.07); }
.np-qi.active { background: rgba(var(--accent-rgb),.15); }
.np-qi.active .np-qi-title { color: var(--accent); }
.np-qi-num {
  font-size: 11.5px; color: rgba(255,255,255,.22);
  min-width: 20px; text-align: right; flex-shrink: 0;
}
.np-qi-art {
  width: 40px; height: 40px; border-radius: 8px;
  overflow: hidden; background: rgba(255,255,255,.07); flex-shrink: 0;
}
.np-qi-art img { width: 100%; height: 100%; object-fit: cover; display: block; }
.np-qi-info { flex: 1; min-width: 0; }
.np-qi-title {
  font-size: 13px; font-weight: 500; color: rgba(255,255,255,.85);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.np-qi-artist {
  font-size: 11.5px; color: rgba(255,255,255,.38); margin-top: 1px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* ══════════════════════════════════════════════════════════════════
   ONBOARDING  — 3-step card
   ══════════════════════════════════════════════════════════════════ */
#onboarding {
  position:fixed; inset:0; z-index:600;
  background:rgba(5,5,5,.98);
  display:flex; align-items:center; justify-content:center;
  backdrop-filter:blur(24px);
  animation:ob-in .4s var(--ease);
}
#onboarding.ob-out { animation:ob-out .4s var(--ease) forwards; }
@keyframes ob-in  { from{opacity:0} to{opacity:1} }
@keyframes ob-out { from{opacity:1} to{opacity:0;pointer-events:none} }

.ob-card {
  background:var(--bg-2); border:1px solid var(--border-2);
  border-radius:var(--r4); padding:40px 44px 34px;
  width:100%; max-width:510px; position:relative;
  box-shadow:0 40px 100px rgba(0,0,0,.8);
  animation:ob-card-in .5s var(--ease);
}
@keyframes ob-card-in { from{transform:translateY(26px) scale(.96);opacity:0} to{transform:none;opacity:1} }

/* Progress dots */
.ob-dots { display:flex; gap:6px; margin-bottom:34px; justify-content:center; }
.ob-dot { width:6px; height:6px; border-radius:3px; background:var(--bg-4); transition:var(--t); }
.ob-dot.on { width:22px; background:var(--accent); }

.ob-body { min-height:290px; }
.ob-icon  { font-size:42px; margin-bottom:14px; line-height:1; }
.ob-h1 { font-family:var(--font-d); font-size:28px; font-weight:800; letter-spacing:-.5px; line-height:1.15; margin-bottom:8px; }
.ob-sub { font-size:14.5px; color:var(--text-3); line-height:1.65; margin-bottom:26px; }

.ob-field { margin-bottom:20px; }
.ob-lbl { display:block; font-size:13px; font-weight:600; color:var(--text-2); letter-spacing:.3px; margin-bottom:8px; }
.ob-input {
  width:100%; padding:13px 15px; background:var(--bg-1);
  border:1px solid var(--border-2); border-radius:var(--r2);
  font-size:15px; color:var(--text-1); outline:none; transition:var(--t);
}
.ob-input:focus { border-color:var(--accent); background:rgba(var(--accent-rgb),.04); }

/* Color swatches */
.ob-swatches { display:flex; gap:9px; flex-wrap:wrap; align-items:center; }
.ob-swatch {
  width:30px; height:30px; border-radius:50%; cursor:pointer;
  border:2px solid transparent; transition:var(--t);
}
.ob-swatch:hover { transform:scale(1.16); }
.ob-swatch.on { border-color:#fff; box-shadow:0 0 0 2px rgba(255,255,255,.45); transform:scale(1.1); }
.ob-custom-color {
  width:30px; height:30px; border-radius:50%; cursor:pointer;
  border:2px solid var(--border-2); overflow:hidden; padding:0;
  background:conic-gradient(red,yellow,lime,cyan,blue,magenta,red);
}

/* Permissions */
.ob-perm {
  display:flex; align-items:center; justify-content:space-between; gap:14px;
  padding:15px 0; border-bottom:1px solid var(--border);
}
.ob-perm:last-child { border-bottom:none; }
.ob-perm-title { font-size:14px; font-weight:600; margin-bottom:2px; }
.ob-perm-desc  { font-size:12.5px; color:var(--text-3); line-height:1.5; }
.ob-perm-ok    { font-size:13px; color:var(--accent); font-weight:600; white-space:nowrap; }

/* Folder step */
.ob-folders { display:flex; flex-direction:column; gap:7px; margin-bottom:4px; }
.ob-folder-tag {
  display:flex; align-items:center; justify-content:space-between;
  padding:9px 13px; background:var(--bg-1); border:1px solid var(--border);
  border-radius:var(--r1); font-size:13px; color:var(--text-2);
}
.ob-folder-rm { color:var(--text-3); cursor:pointer; transition:var(--t); padding:2px 4px; font-size:12px; }
.ob-folder-rm:hover { color:#e5534b; }
.ob-skip { font-size:12px; color:var(--text-3); margin-top:10px; text-align:center; }

.ob-nav { display:flex; justify-content:space-between; align-items:center;
  margin-top:26px; padding-top:18px; border-top:1px solid var(--border); }

/* Repeat badge */
.repeat-1 {
  position:absolute; top:0; right:0; width:13px; height:13px;
  background:var(--accent); color:#000; font-size:8px; font-weight:900;
  border-radius:50%; display:flex; align-items:center; justify-content:center;
}
#btn-repeat { position:relative; }

/* Queue actions */
.queue-actions { display:flex; gap:8px; }

/* Library tabs in view header */
.lib-tabs { display:flex; gap:3px; }

/* ─── Responsive ─────────────────────────────────────────────────── */
@media (max-width:1100px) {
  #side-panel { display:none; }
}
@media (max-width:900px) {
  :root { --sidebar-w:60px; }
  .nav-btn span,.sidebar-playlists { display:none; }
  .nav-btn { justify-content:center; padding:11px; }
  .track-list-header,.track-item { grid-template-columns:36px 46px 1fr 72px 58px; }
  .th-album,.track-album { display:none; }
  .btn-label { display:none; }
}
@media (max-width:640px) {
  :root { --sidebar-w:0px; }
  #sidebar { display:none; }
  .track-list-header,.track-item { grid-template-columns:42px 1fr 58px 42px; }
  .th-num,.track-num,.th-dur,.track-dur { display:none; }
  .player-right { display:none; }
  .player-left  { width:180px; }
}

/* ── Fixes & additions ──────────────────────────────────────────── */
.ob-perm-info { flex:1; min-width:0; }
.ob-folders-list { display:flex; flex-direction:column; gap:7px; margin-bottom:4px; }
.ob-perm-ok { font-size:13px; color:var(--accent); font-weight:600; white-space:nowrap; }

/* Repeat badge — player.js appends this dynamically */
.r1-badge {
  position:absolute; top:0; right:0; width:13px; height:13px;
  background:var(--accent); color:#000; font-size:8px; font-weight:900;
  border-radius:50%; display:flex; align-items:center; justify-content:center;
}

/* NP art pulse while playing */
.np-art.np-art-playing { animation:np-pulse 3s ease-in-out infinite alternate; }
@keyframes np-pulse { from{transform:scale(1)} to{transform:scale(1.025)} }

/* Section title in home that needs today-mix-card without the previous broken div */
.today-mix-card { cursor:pointer; }

/* Seek thumb visibility */



/* ── New settings row variants ─────────────────────────────────── */
.setting-row--col { flex-direction:column; align-items:flex-start; gap:10px; }
.setting-row-top  { display:flex; align-items:center; justify-content:space-between; width:100%; }
.setting-sub      { display:flex; align-items:center; gap:10px; width:100%; font-size:13.5px; color:var(--text-2); }
.setting-sub input[type=range] { flex:1; }
.setting-sub-label { color:var(--text-3); white-space:nowrap; font-size:13px; }
.setting-sub-val   { min-width:32px; text-align:right; font-weight:600; color:var(--accent); font-variant-numeric:tabular-nums; }
/* Dim sub-row when gapless is off */
#s-gapless-sub.dimmed { opacity:0.4; pointer-events:none; }
.setting-hint     { font-size:12px; color:var(--text-3); line-height:1.55; margin-top:2px; }
.setting-badge    { font-size:10px; font-weight:700; letter-spacing:.8px; padding:2px 6px;
  border-radius:4px; background:rgba(var(--accent-rgb),.15); color:var(--accent);
  text-transform:uppercase; vertical-align:middle; margin-left:6px; }

/* ── Density: comfortable mode adds more room everywhere ─────── */
body[data-density="comfortable"] .home-greeting { margin-bottom:30px; }
body[data-density="comfortable"] .today-mix-card { padding:32px 34px; }

/* ── Sidebar playlist items more padding ─────────────────────── */
.sidebar-pl-item { padding:9px 14px; }

/* ── Track action buttons more clickable ─────────────────────── */
.track-action-btn { width:30px; height:30px; }

/* ── Home action buttons more space ──────────────────────────── */
.home-actions { gap:10px; margin-bottom:28px; flex-wrap:wrap; }

/* ── Player center more padding ──────────────────────────────── */
.player-center { padding:0 22px; gap:9px; }

/* ── Seek bar slightly taller hit area ───────────────────────── */
.seek-wrap { padding:8px 0; }
.np-seek-wrap { padding:9px 0; }

/* ── Vol slider wider ────────────────────────────────────────── */
#vol-slider { width:96px; }

/* ── Shortcut rows more space ────────────────────────────────── */
.shortcut-row { padding:12px 0; font-size:14.5px; }

/* ── Equalizer bands more breathing room ─────────────────────── */
.eq-bands { gap:16px; height:170px; margin-bottom:30px; }
.eq-band  { gap:9px; }

/* ── Modal more padding ──────────────────────────────────────── */
#modal { padding:30px; }
#modal-title { font-size:18px; margin-bottom:16px; }

/* ── NP controls bigger (handled in NP block above) ── */

/* ═══════════════════════════════════════════════════════
   TITLEBAR — proper spacing + new elements
   ═══════════════════════════════════════════════════════ */
#titlebar {
  height:58px !important;
  padding:0 20px !important;
  gap:16px !important;
}
.titlebar-left { gap:12px !important; }
.app-logo { display:flex; align-items:center; }
.app-name { font-size:16px !important; letter-spacing:-.4px; }

.topbar-divider {
  width:1px; height:20px;
  background:var(--border-2);
  flex-shrink:0;
}
.win-controls { display:flex; align-items:center; gap:6px; -webkit-app-region:no-drag; }
.win-btn { width:30px !important; height:30px !important; font-size:13px !important; }

.topbar-icon-btn {
  width:34px; height:34px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  background:rgba(255,255,255,.05); border:1px solid var(--border);
  color:var(--text-2); transition:var(--t); -webkit-app-region:no-drag;
  flex-shrink:0;
}
.topbar-icon-btn:hover { background:rgba(255,255,255,.12); color:var(--text-1); }
.topbar-icon-btn svg { width:15px; height:15px; stroke:currentColor; fill:none; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; }

/* Palette dots in titlebar */
.topbar-palette {
  display:flex; align-items:center; gap:5px;
  -webkit-app-region:no-drag; padding:4px 6px;
  background:rgba(255,255,255,.04); border:1px solid var(--border);
  border-radius:20px;
}
.palette-dot {
  width:14px; height:14px; border-radius:50%;
  cursor:pointer; transition:transform 120ms ease, box-shadow 120ms ease;
  border:2px solid rgba(255,255,255,.15);
  flex-shrink:0;
}
.palette-dot:hover { transform:scale(1.35); box-shadow:0 0 0 2px rgba(255,255,255,.25); }
.palette-dot.active { border-color:rgba(255,255,255,.7); transform:scale(1.2); }

/* Light theme */
/* ═══════════════════════════════════════════════════════
   LIGHT THEME — warm slate, not blinding white
   ═══════════════════════════════════════════════════════ */
body.light-theme {
  /* Warm off-white surfaces — never pure white */
  --bg:      #f0ede8;
  --bg-1:    #e8e4de;
  --bg-2:    #dedad3;
  --bg-3:    #d2cdc5;
  --bg-4:    #c5bfb6;

  /* Borders — warm dark with good visibility */
  --border:   rgba(60,50,40,.12);
  --border-2: rgba(60,50,40,.22);

  /* Text — deep warm charcoal, not pure black */
  --text-1:  #1a1714;
  --text-2:  #3d3530;
  --text-3:  #7a7068;

  /* Scrollbar */
  --scroll-thumb: rgba(60,50,40,.18);
}

/* Scrollbar in light mode */
body.light-theme ::-webkit-scrollbar-thumb { background:rgba(60,50,40,.15); }
body.light-theme ::-webkit-scrollbar-thumb:hover { background:rgba(60,50,40,.28); }

/* Titlebar + player bar — slightly darker warm surface */
body.light-theme #titlebar {
  background:rgba(225,219,210,.97) !important;
  border-bottom-color:rgba(60,50,40,.14) !important;
}
body.light-theme #player-bar {
  background:rgba(220,214,205,.98) !important;
  border-top-color:rgba(60,50,40,.14) !important;
}

/* Sidebar — darkest surface for contrast */
body.light-theme #sidebar {
  background:#dbd5cc;
  border-right-color:rgba(60,50,40,.14);
}
body.light-theme .nav-btn { color:var(--text-2); }
body.light-theme .nav-btn:hover { background:rgba(60,50,40,.08); color:var(--text-1); }
body.light-theme .nav-btn.active { background:rgba(60,50,40,.12); color:var(--text-1); }

/* Side panel */
body.light-theme #side-panel { background:var(--bg-1); border-left-color:rgba(60,50,40,.12); }

/* Cards and sections */
body.light-theme .settings-sec,
body.light-theme .pl-card,
body.light-theme .track-card { background:var(--bg-2); border-color:rgba(60,50,40,.1); }
body.light-theme .settings-sec h3 { color:var(--text-3); }

/* Track rows */
body.light-theme .track-item { border-bottom-color:rgba(60,50,40,.07); }
body.light-theme .track-item:hover { background:rgba(60,50,40,.06); }
body.light-theme .track-item.active { background:rgba(60,50,40,.1); }
body.light-theme .track-num { color:var(--text-3); }
body.light-theme .track-dur { color:var(--text-3); }
body.light-theme .track-album { color:var(--text-3); }

/* Seek & progress */
body.light-theme .pb-seek-bg { background:rgba(60,50,40,.14); }
body.light-theme .pb-vol-slider-wrap input[type=range] { background:rgba(60,50,40,.14); }

/* Controls */
body.light-theme .pb-icon-btn { color:var(--text-2); }
body.light-theme .pb-icon-btn:hover { color:var(--text-1); background:rgba(60,50,40,.09); }
body.light-theme .pb-ctrl-sm { color:var(--text-2); }
body.light-theme .pb-ctrl-sm:hover { color:var(--text-1); background:rgba(60,50,40,.09); }
body.light-theme .pb-ctrl { color:var(--text-2); }
body.light-theme .pb-ctrl:hover { color:var(--text-1); background:rgba(60,50,40,.1); }
body.light-theme .pb-play { background:var(--text-1) !important; color:#f0ede8 !important; box-shadow:0 4px 20px rgba(60,50,40,.25); }
body.light-theme .pb-play:hover { box-shadow:0 6px 28px rgba(60,50,40,.35); }

/* Topbar buttons */
body.light-theme .topbar-btn { background:rgba(60,50,40,.07); border-color:rgba(60,50,40,.14); color:var(--text-2); }
body.light-theme .topbar-btn:hover { background:rgba(60,50,40,.13); color:var(--text-1); }
body.light-theme .topbar-icon-btn { background:rgba(60,50,40,.07); border-color:rgba(60,50,40,.14); color:var(--text-2); }
body.light-theme .topbar-icon-btn:hover { color:var(--text-1); background:rgba(60,50,40,.13); }
body.light-theme .topbar-palette { background:rgba(60,50,40,.05); border-color:rgba(60,50,40,.12); }
body.light-theme .win-btn { background:rgba(60,50,40,.07); color:var(--text-2); }
body.light-theme .win-btn:hover { background:rgba(60,50,40,.14); color:var(--text-1); }

/* Search */
body.light-theme #search-input { background:rgba(60,50,40,.07); border-color:rgba(60,50,40,.14); color:var(--text-1); }
body.light-theme #search-input:focus { background:rgba(60,50,40,.1); border-color:rgba(60,50,40,.28); }
body.light-theme #search-input::placeholder { color:var(--text-3); }

/* Toggles */
body.light-theme .toggle { background:rgba(60,50,40,.2); }
body.light-theme input:checked + .toggle { background:var(--accent); }

/* Select inputs */
body.light-theme select,
body.light-theme input[type=number] { background:var(--bg-3); border-color:rgba(60,50,40,.16); color:var(--text-1); }

/* Ghost buttons */
body.light-theme .ghost-btn { border-color:rgba(60,50,40,.18); color:var(--text-2); }
body.light-theme .ghost-btn:hover { background:rgba(60,50,40,.08); color:var(--text-1); }

/* Lib tabs */
body.light-theme .lib-tab { color:var(--text-3); }
body.light-theme .lib-tab.active { color:var(--text-1); border-bottom-color:var(--accent); }

/* EQ */
body.light-theme .eq-bands { background:var(--bg-2); }

/* Now Playing overlay */
body.light-theme #now-playing { background:rgba(230,224,215,.96); }

/* Context menu & modal */
body.light-theme .ctx-menu { background:var(--bg-2); border-color:rgba(60,50,40,.14); box-shadow:0 8px 32px rgba(60,50,40,.18); }
body.light-theme .ctx-item { color:var(--text-1); }
body.light-theme .ctx-item:hover { background:rgba(60,50,40,.07); }
body.light-theme .ctx-sep { background:rgba(60,50,40,.1); }
body.light-theme #modal { background:var(--bg-1); border-color:rgba(60,50,40,.14); }
body.light-theme #modal-overlay { background:rgba(30,24,18,.4); }

/* Toast */
body.light-theme .toast { background:var(--text-1); color:#f0ede8; }

/* ═══════════════════════════════════════════════════════
   SETTINGS — make sure visible + spacious
   ═══════════════════════════════════════════════════════ */
#settings-panel {
  max-width:640px !important;
  display:flex !important;
  flex-direction:column !important;
  gap:24px !important;
  padding-bottom:60px;
}
.settings-sec { padding:28px 30px !important; }
.settings-sec h3 { font-size:11px !important; font-weight:800 !important; letter-spacing:1.5px !important; text-transform:uppercase; margin-bottom:20px !important; color:var(--text-3) !important; }
.setting-row { padding:16px 0 !important; min-height:52px; }
.setting-row > label:first-child { font-size:14.5px !important; }
.setting-row input[type=range] { flex:1; min-width:120px; }
.setting-row select, .setting-row input[type=number] { padding:8px 12px; border-radius:var(--r1); background:var(--bg-3); border:1px solid var(--border); color:var(--text-1); font-size:13.5px; }

/* Gapless sub-row */
.setting-sub {
  display:flex !important;
  align-items:center;
  gap:10px; width:100%;
  padding:10px 14px;
  background:var(--bg-3); border-radius:var(--r2);
  margin-top:4px;
}
.setting-sub.dimmed { opacity:.4; pointer-events:none; }
.setting-sub-label { color:var(--text-3); white-space:nowrap; font-size:13px; }
.setting-sub-val { min-width:34px; text-align:right; font-weight:700; color:var(--accent); font-variant-numeric:tabular-nums; font-size:15px; }
.setting-hint { font-size:12.5px; color:var(--text-3); line-height:1.6; margin-top:8px; padding:0 2px; }
.setting-hint strong { color:var(--accent); }
.setting-badge { font-size:9px; font-weight:800; letter-spacing:1px; padding:2px 7px; border-radius:4px; background:rgba(var(--accent-rgb),.15); color:var(--accent); text-transform:uppercase; vertical-align:middle; margin-left:6px; }
.setting-row-top { display:flex; align-items:center; justify-content:space-between; width:100%; }
.setting-row--col { flex-direction:column; align-items:flex-start; gap:6px; }

